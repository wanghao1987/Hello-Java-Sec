<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{commons/commons::head}"></div>

<body>

<script>
   function submitFun() {
    	var inputdata = $('#qinput').val();
        $.ajax({
            url: '/SQLI/MyBatis/vul/blind',
            method: 'GET',
            dataType:"json",
            data: {
            	"q": inputdata
            },
            error: function (xhr, ajaxOptions, thrownError) {
            	$('#sqlTableVul tbody').empty();
                $('#errorDiv').html(xhr.responseText);
            },
            
            success: function (data) {
            	$('#errorDiv').val('');
            	$('#errorDiv').html('');
            	$('#sqlTableVul tbody').empty();
                $.each(data, function (index, item) {
                    $('#sqlTableVul tbody').append('<tr><td>' + item.id + '</td>' + 
                    		'<td>' + item.movie_name + '</td>' + 
                    		'<td>' + item.publish_date + '</td>' + 
                    		'<td>' + item.characters + '</td>' + 
                    		'<td>' + item.gener + '</td>' + 
                    		'<td>' + item.score + '</td>' + 
                    		'</tr>');
                });
            }
        });
    }
</script>

<!-- é¡¶éƒ¨å¯¼èˆªæ � -->
<div th:replace="~{commons/commons::topbar}"></div>

<div class="container-fluid">
    <div class="row">
        <!-- ä¾§è¾¹æ � -->
        <div th:replace="~{commons/commons::siderbar(active='sqli_mybatis_blind.html')}"></div>

        <main role="main" class="col-md-10 ml-sm-auto pt-3 px-4">
            <div class="vul_header">
                <span>SQL Injection - MyBatis</span>
            </div>
            <hr>
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#aa"><span class="lnr lnr-bug"></span>
                        Vulnerability description</a>
                </li>
               
            </ul>

            <div class="tab-content">
                <div class="tab-pane dec shadow-sm p-3 mb-4 rounded active" id="aa">                    
SQL injection (SQLI) occurs when a program fails to properly check user input and incorporates it into an SQL statement by concatenation, leading to SQL injection. Attackers can directly access database information and cause information leakage through SQL injection. While the underlying MyBatis framework has implemented defenses against SQL injection, there still remains a risk of SQL injection when it is improperly used.
                </div>               
            </div>
            <hr>

            <div class="box-float">
                <div class="float1">                   
                    <h5><span class="lnr lnr-bug"> Input movie name and click search</span></h5>
                    <br/>
                   
                    <br/>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" id="qinput"
                                   value="" style="color: #b5babb">
                            <div class="input-group-append">
                                <button class="btn btn-sm btn-danger" id = 'searchButton' onclick= "submitFun()">search</button>
                            </div>
                        </div>   
                        
                         <div class="form-group">
                                    <table class="table table-striped table-bordered table-sm" id="sqlTableVul">
                                        <thead>
                                        <tr>
                                            <th>Id</th>
                                            <th>Name</th>
                                            <th>Release Date</th>
                                            <th>Character</th>
                                            <th>Gener</th>
                                            <th>Score</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                          </div> 
                          <div id = 'errorDiv'></div>                    
                    
                   </div>
                  
			</div>
            
        </main>
    </div>
</div>


<!-- å¼•å…¥script -->
<div th:replace="~{commons/commons::script}"></div>


</body>

</html>